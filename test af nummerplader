#include <stdio.h>
#include <string.h>


int line_exists(FILE *file, const char *input) {
    char line[256];
    rewind(file);
    while (fgets(line, sizeof(line), file) != NULL) {

        line[strcspn(line, "\n")] = 0;
        if (strcmp(line, input) == 0) {
            return 1; // gen bruger
        }
    }
    return 0; // ny bruger
}

int main() {
    // Ã¥bner filen i reading og apending
    FILE *file = fopen("Nummerplader.txt", "a+");
    if (file == NULL) {
        printf("Error opening file!\n");
        return 1;
    }

    char input[256]; // Buffer til bruger input
    printf("Enter numberplate to write to the file (type 'exit' to quit):\n");

    while (1) {
        printf("> ");
        fgets(input, sizeof(input), stdin); // bruger input


        input[strcspn(input, "\n")] = 0;


        if (strcmp(input, "exit") == 0) {
            break;
        }

        // skriv bruger input i filen
        if (line_exists(file, input)) {
            printf("The numberplate '%s' is already registrated\n", input);
        } else {
            fprintf(file, "%s\n", input);
        }
        fflush(file);
    }
    if (line_exists(file, input)) {
        printf("The line '%s' already exists in the file. Skipping...\n", input);
    }
    // lukker filen
    fclose(file);

    printf("User data successfully saved to 'Nummerplader.txt'.\n");

    FILE *file2 = fopen("Nummerplader.txt", "r");
    while (fgets(input, sizeof(input), file2) != NULL) {
        printf("%s", input); // Printer hver linje
    }

    return 0;
}
